<html>
  <head>
    <title>React Ellipse</title>
    <meta charset="utf-8" />
    <link
      rel="stylesheet"
      href="../node_modules/bootstrap/dist/css/bootstrap.min.css"
    />
  </head>

  <body>
    <div class="container mt-5">
      <button class="btn btn-lg btn-primary">Launch Ellipse Modal</button>
    </div>

    <script src="../node_modules/react/umd/react.development.js"></script>
    <script src="../node_modules/react-dom/umd/react-dom.development.js"></script>
    <script src="../node_modules/styled-components/dist/styled-components.js"></script>
    <script src="../node_modules/@babel/standalone/babel.min.js"></script>
    <script src="../node_modules/jquery/dist/jquery.min.js"></script>
    <script src="../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../node_modules/bootbox/bootbox.min.js"></script>
    <script src="../dist/decsys.rating-scales.js"></script>

    <script type="text/babel">
      document.querySelector("button").addEventListener("click", e => {
        const modal = bootbox.dialog({
          title: "Ellipse Modal Test",
          message: "<p>Loading...</p>",
          onEscape: true,
          size: "large",
          closeButton: false,
          backdrop: true
        });

        const renderEllipse = () => {
          ReactDOM.render(
            <DECSYS.EllipseScale
              barOptions={{
                minValue: 1,
                maxValue: 10,
                thickness: "0.5em"
              }}
              labels={{
                min: "Easy",
                mid: "Ok",
                max: "Hard"
              }}
              labelOptions={{
                yAlign: "above"
              }}
              question="How?"
              questionOptions={{
                xAlign: "center"
              }}
              minRangeValue={4.5}
              maxRangeValue={10}
              frameHeight="300px"
              penOptions={{
                color: "cornflowerblue",
                thickness: 5
              }}
              rangeMarkerOptions={{
                markerColor: "red",
                length: "100px",
                thickness: "2em"
              }}
              heightElements=".modal-dialog"
            />,
            document.querySelector("#ellipse")
          );

          document.addEventListener("EllipseCompleted", e => {
            document.querySelector("#results").innerHTML = `<dl>
                                                    <dt>Min</dt><dd>${
                                                      e.detail.minRangeValue
                                                    }</dd>
                                                    <dt>Max</dt><dd>${
                                                      e.detail.maxRangeValue
                                                    }</dd>
                                                </dl>`;
          });
        };

        modal.init(() => {
          modal.find(".bootbox-body").html(
            `<div id="ellipse"></div>
                                            <div id="results"></div>`
          );

          // doesn't work if it's rendered too fast, as the rest of the dom isn't ready.
          // what can we do to make this better i wonder
          setTimeout(renderEllipse, 300);
        });
      });
    </script>
  </body>
</html>
